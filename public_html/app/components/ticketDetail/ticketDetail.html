<div class="main-content">
    <div class="header-content" style="clear: both; margin-bottom: 0px;height: 40px;border-bottom: 1px solid #e4e6e8;">
        <div class="row action-content" style="padding-left:10px ; margin:10px">
            <span>
                <span class="title-header-content">
                 
                </span>
                <h3 style="display:inline" class=""><i style="margin-right:5px" class="fa fa-globe  fa-1.9x" aria-hidden="true"></i> <b>Thông tin</b></h3>
            </span>
            <div class="group-action-content group-action-request-content" style="padding-bottom:50px ; float:right">
                <div style="">
                    <span  class="dropdown" >
                        <button class="btn btn-sm dropdown-toggle" data-toggle="dropdown"><i class="fa fa-users" aria-hidden="true" ></i> Thay đổi bộ phận  IT
                        </button>

                            <ul class="dropdown-menu">

                                <li data-toggle="modal" data-target="#myModal2" ng-click="newInfo.team_id = 1; console.log(newInfo)">  <a>{{1 | toTeam}}</a> </li>
                                <li data-toggle="modal" data-target="#myModal2" ng-click="newInfo.team_id = 2;console.log(newInfo)">  <a>{{2 | toTeam}}</a> </li>
                            </ul>
                    </span> 

                    <span class="deadline">
                        <button class="btn btn-sm" data-toggle="modal" data-target="#myModal3"><i class="fa fa-calendar" aria-hidden="true"  style="color: #38d1c9"></i> Thay đổi deadline 
                        </button>
                    </span>

                    <span  class="dropdown" >
                            <button class="btn btn-sm dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-edit" aria-hidden="true"  style="color: #e28624"></i> Thay đổi độ ưu tiên
                            </button>
                            <ul class="dropdown-menu">
                                <li ng-repeat="priority in getPriority()"  data-toggle="modal" data-target="#myModal2" ng-click="changeNewPriority(priority)">  <a>{{priority | toPriority}}</a> </li>
                            </ul>
                    </span> 
                    <span class="dropdown set-up-status">
                            <button class="btn btn-sm dropdown-toggle" data-toggle="dropdown">
                                    <i class="fa fa-exchange" aria-hidden="true" style="color: #813384"></i> Thay đổi trạng thái
                            </button>
                            <ul class="dropdown-menu">
                                <li ng-repeat="status in getStatus()" data-toggle="modal" data-target="#myModal2" ng-click="changeNewStatus(status)">  <a>{{status | toTicketStatus}}</a> </li>
                            </ul>
                    </span>

                    <button class="btn btn-sm "  style="" data-toggle="modal" data-target="#myModal5"><i class="fa fa-hand-o-right" aria-hidden="true"  style="color: #0ea432"></i> Assign
                    </button>
                    </span>
                    <span style="">
                        <span class="relaters" style="">
                                <button class="btn btn-sm" data-toggle="modal" data-target="#myModal4"><i class="fa fa-user" aria-hidden="true"  style="color: #70ffa6" ></i> Thay đổi người  liên quan
                                </button>
                        </span>
                    </span>
                </div>
                <br>
                
            </div>
        </div>
    </div>
    <div class="body-content" style="font-weight:100">
        <div class="row request-info" style="margin-left:30px">
            <div class="col-md-4" style="padding: 0px">
                <div class="row">
                    <label class="col-md-6 request-label">Ngày tạo:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.created_at  | date: "dd-MM-yyyy"}}</div>
                </div>
                <div class="row">
                    <label class="col-md-6 request-label">Người yêu cầu:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.created_by }}</div>
                </div>
                <div class="row">
                    <label class="col-md-6 request-label">Mức độ ưu tiên:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.priority | toPriority}}</div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="row">
                    <label class="col-md-6 request-label">Ngày hết hạn:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.deadline  | date: "dd-MM-yyyy"}} </div>
                </div>
                <div class="row">
                    <label class="col-md-6 request-label">Người thực hiện:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.assigned_to}} </div>
                </div>
                <div class="row">
                    <label class="col-md-6 request-label">Trạng thái:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.status | toTicketStatus}} </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="row">
                    &nbsp;
                </div>
                <div class="row">
                    <label class="col-md-6 request-label">Bộ phận IT:</label>
                    <div class="col-md-6" style="padding-left:0px"> {{ ticket.team_id | toTeam}}</div>
                </div>
                <div class="row">
                    <label class="col-md-6 request-label">Người liên quan:</label>
                    <div class="col-md-6"style="padding-left:0px" ng-repeat="relater in ticket.relaters"> {{ relater.display_name }}</div>
                </div>
            </div>
        </div>
        <hr>
        <div style="margin-top:100px">   
                <div>    
                    <div style="display:inline"> <img  class="img-circle" style="height:50px;width:50px;border: 1px solid #ddd;padding: 5px;"src="{{info.user.picture}}">
                    <h5 class="w3-opacity"  style="display:inline"></h5><b> {{info.user.user_name}}</b></h5>
                    <br>
                </div>
                    
                </div>
                <img src="{{ticket.attachment_url}}" style="max-height:300px ; max-width:500px">                 
                <p style="display:inline; padding-left: 30px ; vertical-align: top;"> {{ ticket.content}}</p>
                <h6 class="w3-text-teal"><i class="fa fa-calendar fa-fw w3-margin-right"></i>Jan 2015 - <span class="w3-tag w3-teal w3-round">Current</span></h6>
                
                <hr>
        </div>
    </div>
</div>

<div id="comment-content">
    <div ng-repeat="comment in comments">
            <hr>
            <div style="border-bottom: 1px solid #efefef;  padding-bottom: 10px; padding-top: 8px; width: 100%;">
                <table style="width:100%">
                    <tr style="width:100%">
                        <td style="vertical-align: top; padding-right: 15px; width:20%">
                        <img  class="img-circle" style="height:50px;width:50px;border: 1px solid #ddd;padding: 5px;" src="{{comment.commented_by.picture}}"> </img>
                        <span class="user-comment">  {{ comment.commented_by.display_name  }}</span>
                        <h6 class="w3-text-teal"><i class="fa fa-calendar fa-fw w3-margin-right"></i> {{ comment.created_at  | date: "dd-MM-yyyy"}} </h6>
                        </td>

                              
                        <td style="vertical-align: top; background-color:#e0dff7; width:75%" ng-if="$index % 2 == 1">
                                <div ng-bind-html="comment.content"  ></div>        
                        </td>
                        <td style="vertical-align: top;background-color:#d0f3dd; width:75%" ng-if="$index % 2 == 0" >
                            <div ng-bind-html="comment.content"  ></div>
                        </td>
                        
                        <td style="vertical-align: top; width:5%" >
                        </td>
                    </tr>
                </table>
            </div>
    </div>
</div>


<div class="input-discussion" style="border-top: solid 1px #e9ebee; padding-top: 40px">    
    <textarea tyle="text" class="form-control" rows="10" style="height:80px"ng-model="commentInput2"></textarea>
    <button class="btn btn-sm btn-info form-control" ng-click="createComment()">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        Gửi bình luận
    </button>
</div>




<div id="myModal2" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class=" modal-header w3-container w3-red">
                    <h3> chú thích: </h3>
                </div>

                <div class="modal-body">
                    <input type="text" ng-model="commentInput" class="form-control">
                </div>
                <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal"> Cancle </button>
                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="saveChange()"> Save </button>
                </div>
            </div>    
        </div>
</div>


<div id="myModal3" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class=" modal-header w3-container w3-red">
                    <h3> chú thích: </h3>
                </div>

                <div class="modal-body">
                    <label> select new deadline :  </label>
                    <br>
                    <input type="datetime-local" ng-model="newInfo.deadline" >
                    <br>
                    <label> Note :  </label>
                    <textarea type="text" ng-model="commentInput" class="form-control"></textarea>
                </div>
                <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal"> Cancle </button>
                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="saveChange()"> Save </button>
                </div>
            </div>    
        </div>
</div>



<div id="myModal4" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class=" modal-header w3-container w3-red">
                    <h3> Thay đổi người liên quan: </h3>
                </div>
                <div class="modal-body">
                    <label> nhập người liên quan:  </label>
                  
                        <div class="form-control" >
                            <div style="display:inline-block"> 
                                <ul>
                                    <span class="label label-success" style="display:inline-block;" ng-repeat="related in ticket.relaters" ng-click="removeRelatedUser( related.id )"> {{ related.user_name }} ;</span>
                                </ul>
                            </div>              
                            <div class="dropdown"  style="display:inline-block" >
                                    <input style="outline:none; background:transparent;border:none"   data-toggle="dropdown" ng-model="inputName" ng-keyup="searchName(inputName)">
                                    <div class="dropdown-menu" ng-show="user_recommend.length > 0">
                                          <li ng-repeat="u in user_recommend" ng-click="addRelatedUser(u)"><a> {{u.user_name }} </a></li>
                                    </div>
                            </div>
                        </div>
                    <br>
                    <label> Note:  </label>
                    <textarea type="text" ng-model="commentInput" class="form-control"></textarea>
                </div>
                <div class="modal-footer">
                     <button type="button" class="btn btn-default" data-dismiss="modal"> Cancle </button>
                     <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="changeRelater()"> Save </button>
                </div>
            </div>    
        </div>
</div>
    



<div id="myModal5" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class=" modal-header w3-container w3-red">
                    <h3> Thay đổi người thực hiện: </h3>
                </div>
                <div class="modal-body">
                    <label> nhập tên người thực hiện:  </label>
                        <div class="form-control" >
                            <div style="display:inline-block"> 
                                <ul>
                                    <span class="label label-success" style="display:inline-block;"  ng-click="deleteAssignTo()"> {{ assign_to_input.user_name }} ;</span>
                                </ul>
                            </div>              
                            <div class="dropdown"  style="display:inline-block" >
                                    <input style="outline:none; background:transparent;border:none"   data-toggle="dropdown" ng-model="inputName" ng-keyup="searchName(inputName)">
                                    <div class="dropdown-menu" ng-show="user_recommend.length > 0">
                                          <li ng-repeat="u in user_recommend" ng-click="addAssignTo(u)"><a> {{u.user_name }} </a></li>
                                    </div>
                            </div>
                        </div>
                    <br>
                    <label> Note:  </label>
                    <textarea type="text" ng-model="commentInput" class="form-control"></textarea>
                </div>
                <div class="modal-footer">
                     <button type="button" class="btn btn-default" data-dismiss="modal"> Cancle </button>
                     <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="changeAssign()"> Save </button>
                </div>
            </div>    
        </div>
</div>
    


